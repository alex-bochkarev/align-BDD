rm -rf .//instances/*
rm -rf .//run_logs/*
touch ./clean
rm -rf ./figures/*.eps
mkdir -p ./run_logs
mkdir -p ./instances
rm ./clean
cp --preserve=timestamps -r ./run_logs /local_scratch/pbs.2625306.pbs02//run_logs
cp --preserve=timestamps -r ./instances /local_scratch/pbs.2625306.pbs02//instances
rm -rf /local_scratch/pbs.2625306.pbs02//instances/orig_problem && \
			mkdir /local_scratch/pbs.2625306.pbs02//instances/orig_problem && \
			parallel -j 64 'python -m gen_BDD_pair -s $(( 51 * {#} - 51))' -K 51 -v 15 -p 0.6 -R -U /local_scratch/pbs.2625306.pbs02//instances/orig_problem/ --quiet ::: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 && \
			ls /local_scratch/pbs.2625306.pbs02//instances/orig_problem | grep -Po "A\\K[^\\.]*" > /local_scratch/pbs.2625306.pbs02//instances/orig_problem.list && \
			if [ "/local_scratch/pbs.2625306.pbs02/" != "./" ]; then \
				cp -r /local_scratch/pbs.2625306.pbs02//instances/orig_problem ./instances/; \
				cp /local_scratch/pbs.2625306.pbs02//instances/orig_problem.list ./instances/; \
			fi
mkdir -p /local_scratch/pbs.2625306.pbs02//instances/scal && \
			parallel -j 64 'python -m gen_BDD_pair -s $(( 100 * {#} - 100))' -K 100 -v {} -p 0.6 -R -U /local_scratch/pbs.2625306.pbs02//instances/scal/ --quiet ::: 6 9 5 8 10 7 && \
			ls /local_scratch/pbs.2625306.pbs02//instances/scal | grep -Po "A\\K[^\\.]*" > /local_scratch/pbs.2625306.pbs02//instances/scal/instances.list && \
			if [ "/local_scratch/pbs.2625306.pbs02/" != "./" ]; then \
				cp -r /local_scratch/pbs.2625306.pbs02//instances/scal ./instances/; \
			fi
python -m experiments.heu_sol_struct -k 500 -n 7 > /local_scratch/pbs.2625306.pbs02//run_logs/simpl_sol_struct.csv && \
			if [ "/local_scratch/pbs.2625306.pbs02/" != "./" ]; then cp /local_scratch/pbs.2625306.pbs02//run_logs/simpl_sol_struct.csv ./run_logs/; fi
parallel -j 64 python -m experiments.tUFLP_runtimes -K 100 -n {} --with-gsifts -l /local_scratch/pbs.2625306.pbs02//instances/tUFLP_scal_inst.json.tmp.{} ">" /local_scratch/pbs.2625306.pbs02//run_logs/tUFLP_runtimes_scal.csv.tmp.{} ::: 14 12 7 9 13 15 10 11 6 5 8 && \
			python -m experiments.tUFLP_runtimes -H > /local_scratch/pbs.2625306.pbs02//run_logs/tUFLP_runtimes_scal.csv && \
			cat /local_scratch/pbs.2625306.pbs02//run_logs/tUFLP_runtimes_scal.csv.tmp.* >> /local_scratch/pbs.2625306.pbs02//run_logs/tUFLP_runtimes_scal.csv && rm /local_scratch/pbs.2625306.pbs02//run_logs/tUFLP_runtimes_scal.csv.tmp.* && \
			:> /local_scratch/pbs.2625306.pbs02//instances/tUFLP_scal_inst.json && \
			cat /local_scratch/pbs.2625306.pbs02//instances/tUFLP_scal_inst.json.tmp.* >> /local_scratch/pbs.2625306.pbs02//instances/tUFLP_scal_inst.json && rm /local_scratch/pbs.2625306.pbs02//instances/tUFLP_scal_inst.json.tmp.* && \
			if [ "/local_scratch/pbs.2625306.pbs02/" != "./" ]; then \
				cp /local_scratch/pbs.2625306.pbs02//run_logs/tUFLP_runtimes_scal.csv ./run_logs/; \
				cp /local_scratch/pbs.2625306.pbs02//instances/tUFLP_scal_inst.json ./instances/ ; \
			fi
mkdir -p /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm && \
			python -m experiments.jUFL_hist_sizes -H > /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/jUFLP.csv && \
			parallel -j 64 python -m experiments.jUFL_hist_sizes -n 20 -K 16 -p 0.3 -P {} -l /local_scratch/pbs.2625306.pbs02//instances/jUFLP_inst.tmp.{} ">>" /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/jUFLP.csv.tmp.{} ::: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 && \
			cat /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/jUFLP.csv.tmp.* >> /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/jUFLP.csv && rm /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/jUFLP.csv.tmp.* && \
			cat /local_scratch/pbs.2625306.pbs02//instances/jUFLP_inst.tmp* > /local_scratch/pbs.2625306.pbs02//instances/jUFLP_instances.json && \
			rm /local_scratch/pbs.2625306.pbs02//instances/jUFLP_inst.tmp* && \
			if [ "/local_scratch/pbs.2625306.pbs02/" != "./" ]; then \
				mkdir -p ./run_logs/heu_bm ; \
				cp /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/jUFLP.csv ./run_logs/heu_bm/; \
				cp /local_scratch/pbs.2625306.pbs02//instances/jUFLP_instances.json ./instances/ ; \
			fi
mkdir -p /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm && \
			python -m experiments.tUFL_hist_sizes_control -H > /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_nat.csv && \
			parallel -j 64 python -m experiments.tUFL_hist_sizes_control -n 20 -K 16 -p 0.3 -P {} -l /local_scratch/pbs.2625306.pbs02//instances/tUFLP_nat_inst.tmp.{} ">>" /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_nat.csv.tmp.{} ::: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 && \
			cat /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_nat.csv.tmp.* >> /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_nat.csv && rm /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_nat.csv.tmp.* && \
			cat /local_scratch/pbs.2625306.pbs02//instances/tUFLP_nat_inst.tmp* > /local_scratch/pbs.2625306.pbs02//instances/tUFLP_nat_instances.json && \
			rm /local_scratch/pbs.2625306.pbs02//instances/tUFLP_nat_inst.tmp* && \
			if [ "/local_scratch/pbs.2625306.pbs02/" != "./" ]; then \
				mkdir -p ./run_logs/heu_bm ; \
				cp /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_nat.csv ./run_logs/heu_bm/ ; \
				cp /local_scratch/pbs.2625306.pbs02//instances/tUFLP_nat_instances.json ./instances/ ; \
			fi
mkdir -p /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm && \
			python -m experiments.tUFL_hist_sizes_control -H > /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_rnd.csv && \
			parallel -j 64 python -m experiments.tUFL_hist_sizes_control -R -n 20 -K 16 -p 0.3 -P {} -l /local_scratch/pbs.2625306.pbs02//instances/tUFLP_rnd_inst.tmp.{} ">>" /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_rnd.csv.tmp.{} ::: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 && \
			cat /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_rnd.csv.tmp.* >> /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_rnd.csv && rm /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_rnd.csv.tmp.* && \
			cat /local_scratch/pbs.2625306.pbs02//instances/tUFLP_rnd_inst.tmp* > /local_scratch/pbs.2625306.pbs02//instances/tUFLP_rnd_instances.json && \
			rm /local_scratch/pbs.2625306.pbs02//instances/tUFLP_rnd_inst.tmp* && \
			if [ "/local_scratch/pbs.2625306.pbs02/" != "./" ]; then \
				mkdir -p ./run_logs/heu_bm/ ; \
				cp /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/tUFLP_rnd.csv ./run_logs/heu_bm/ ; \
				cp /local_scratch/pbs.2625306.pbs02//instances/tUFLP_rnd_instances.json ./instances/ ; \
			fi
mkdir -p /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm && \
			rm -rf /local_scratch/pbs.2625306.pbs02//instances/bm_heu_inst && \
			mkdir -p /local_scratch/pbs.2625306.pbs02//instances/bm_heu_inst && \
			python -m experiments.rnd_dia_hist_sizes_control -H > /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/rnd_dia.csv && \
			parallel -j 64 python -m experiments.rnd_dia_hist_sizes_control -n 15 -K 16 -p 0.6 -P {} -l /local_scratch/pbs.2625306.pbs02//instances/bm_heu_inst ">>" /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/rnd_dia.csv.tmp.{} ::: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 && \
			cat /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/rnd_dia.csv.tmp.* >> /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/rnd_dia.csv && rm /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/rnd_dia.csv.tmp.* && \
			tar czf /local_scratch/pbs.2625306.pbs02//instances/bm_heu_random_diagrams.tar.gz -C /local_scratch/pbs.2625306.pbs02//instances/bm_heu_inst . --remove-files && \
			if [ "/local_scratch/pbs.2625306.pbs02/" != "./" ]; then \
				mkdir -p ./run_logs/heu_bm ; \
				cp /local_scratch/pbs.2625306.pbs02//run_logs/heu_bm/rnd_dia.csv ./run_logs/heu_bm/ ; \
				cp /local_scratch/pbs.2625306.pbs02//instances/bm_heu_random_diagrams.tar.gz ./instances/ ; \
			fi
mkdir -p /local_scratch/pbs.2625306.pbs02//instances/orig_stats && \
			parallel mkdir -p /local_scratch/pbs.2625306.pbs02//instances/orig_stats/{} ::: 0.2 0.5 0.8 && \
			parallel -j 64 python -m gen_BDD_pair -v 15 -K 6 -p 0.6 -R -U /local_scratch/pbs.2625306.pbs02//instances/orig_stats/{1} --quiet ::: 0.2 0.5 0.8 ::: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 && \
			parallel find /local_scratch/pbs.2625306.pbs02//instances/orig_stats/{}/*.bdd ">" /local_scratch/pbs.2625306.pbs02//instances/orig_stats/{}/inst.list ::: 0.2 0.5 0.8 && \
			python -m gen_lsizes_stats -H /local_scratch/pbs.2625306.pbs02//run_logs/lwidths.log && \
			parallel python -m gen_lsizes_stats -s {} /local_scratch/pbs.2625306.pbs02//instances/orig_stats/{}/inst.list ">" /local_scratch/pbs.2625306.pbs02//run_logs/lwidths.tmp.{} ::: 0.2 0.5 0.8 && \
			cat /local_scratch/pbs.2625306.pbs02//run_logs/lwidths.tmp.* >> /local_scratch/pbs.2625306.pbs02//run_logs/lwidths.log && rm /local_scratch/pbs.2625306.pbs02//run_logs/lwidths.tmp.* && \
			tar czf /local_scratch/pbs.2625306.pbs02//instances/orig_stats.tar.gz -C /local_scratch/pbs.2625306.pbs02//instances/orig_stats . --remove-files && \
			if [ "/local_scratch/pbs.2625306.pbs02/" != "./" ]; then \
				cp /local_scratch/pbs.2625306.pbs02//run_logs/lwidths.log ./run_logs/ ; \
				cp /local_scratch/pbs.2625306.pbs02//instances/orig_stats.tar.gz ./instances/ ; \
			fi
# instance,N,is_reduced,<comma-separated layer-widths>,<suffix>
Traceback (most recent call last):
  File "/home/abochka/.conda/envs/ab-local/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/abochka/.conda/envs/ab-local/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/abochka/BDD/align-BDD/gen_lsizes_stats.py", line 32, in <module>
    bdd.load(inst_name)
  File "/home/abochka/BDD/align-BDD/BDD.py", line 607, in load
    id, line = line.split(':')
ValueError: not enough values to unpack (expected 2, got 1)
Traceback (most recent call last):
  File "/home/abochka/.conda/envs/ab-local/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/abochka/.conda/envs/ab-local/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/abochka/BDD/align-BDD/gen_lsizes_stats.py", line 32, in <module>
    bdd.load(inst_name)
  File "/home/abochka/BDD/align-BDD/BDD.py", line 607, in load
    id, line = line.split(':')
ValueError: not enough values to unpack (expected 2, got 1)
make: *** [Makefile:241: /local_scratch/pbs.2625306.pbs02//run_logs/lwidths.log] Error 2
make: *** Waiting for unfinished jobs....
make: *** Deleting file '/local_scratch/pbs.2625306.pbs02//run_logs/simpl_sol_struct.csv'
make: *** [Makefile:155: /local_scratch/pbs.2625306.pbs02//run_logs/simpl_sol_struct.csv] Terminated
 
 
+------------------------------------------+ 
| PALMETTO CLUSTER PBS RESOURCES REQUESTED | 
+------------------------------------------+ 
 
mem=500gb,walltime=05:00:00,ncpus=32
 
 
+-------------------------------------+ 
| PALMETTO CLUSTER PBS RESOURCES USED | 
+-------------------------------------+ 
 
cput=04:50:16,mem=13646576kb,walltime=00:16:23,ncpus=32,cpupercent=1761,vmem=13646576kb
 
 
